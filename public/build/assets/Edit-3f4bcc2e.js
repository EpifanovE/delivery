import{r as W,d as t,F as u,j as a}from"./client-182d8dba.js";import{h as F}from"./moment-fbc5633a.js";import{_ as Y,n as A,i as f,h as g}from"./app-44caa45f.js";import{A as B,P as q}from"./PageTitle-d9e0c608.js";import{T as h}from"./TextInput-f11edc02.js";import{I as l,L as d,F as I}from"./EditPage-6acf2f0c.js";import{C as L}from"./Container-65b3b15c.js";import{C as w,a as H,b as P,c as G}from"./Card-f5048bf7.js";import{I as b}from"./InputError-9e8a7810.js";import{B as v}from"./Button-aab750b6.js";import{S as R}from"./SelectInput-6fe57391.js";import U from"./DeliverySettings-07a57b7b.js";import{T as $,I as z}from"./ImageControl-4a04938f.js";import{u as J}from"./useTranslation-7f77c7c2.js";const K=m=>{var y,k,N,C,_,x,D;const{t:s}=J(),{item:e,types:o}=m,{data:n,setData:i,errors:p,processing:c,post:T}=Y({name:((y=e==null?void 0:e.data)==null?void 0:y.name)||"",type:((k=e==null?void 0:e.data)==null?void 0:k.type)||"",token:((N=e==null?void 0:e.data)==null?void 0:N.token)||"",settings:((C=e==null?void 0:e.data)==null?void 0:C.settings)||{}});W.useEffect(()=>{!n.type&&o.length&&i("type",o[0])},[o]);const O=r=>{r.preventDefault(),r.preventDefault(),e!=null&&e.data.id?g.post(route("bots.update",{bot:e.data.id}),{...n,_method:"put"},{forceFormData:!0}):T(route("bots.store"),{forceFormData:!0})},S=()=>{e&&g.post(route("bots.setWebHook",{bot:e.data.id}))},j=()=>{e&&g.post(route("bots.removeWebHook",{bot:e.data.id}))},E=r=>{i("settings",r)},M=r=>{i("settings",{...n.settings,image:r})};return t(u,{children:[a(A,{title:s("bot")}),a("div",{className:"py-12",children:a("form",{onSubmit:O,children:t(L,{children:[t("div",{className:"flex justify-end",children:[!!(e!=null&&e.data.token)&&a(u,{children:e!=null&&e.data.webhook?a(v,{variant:"primaryOutline",type:"button",disabled:c,onClick:j,className:"mr-2",children:s("buttons.remove_webhook")}):a(v,{variant:"primaryOutline",type:"button",disabled:c,onClick:S,className:"mr-2",children:s("buttons.set_webhook")})}),a(v,{variant:"primary",type:"submit",processing:c,children:s("buttons.save")})]}),a(w,{children:t(H,{children:[(e==null?void 0:e.data.id)&&t(l,{children:[a(d,{children:"ID"}),a("div",{className:"flex-1",children:a(h,{value:e.data.id+"",readOnly:!0,className:"w-full"})})]}),t(l,{children:[a(d,{htmlFor:"name",children:s("name")}),t("div",{className:"flex-1",children:[a(h,{id:"name",value:n.name,className:"w-full",handleChange:r=>i("name",r.target.value),required:!0,disabled:c}),a(b,{className:"mt-2",message:p.name})]})]}),t(l,{children:[a(d,{htmlFor:"type",children:s("type")}),t("div",{className:"flex-1",children:[a(R,{value:n.type,handleChange:r=>i("type",r.target.value),id:"type",className:"w-full",required:!0,disabled:c,children:o.map(r=>a("option",{value:r,children:s(`bot_types.${r}`)},r))}),a(b,{className:"mt-2",message:p.type})]})]}),t(l,{children:[a(d,{htmlFor:"token",children:s("token")}),t("div",{className:"flex-1",children:[a(h,{id:"token",value:n.token,className:"w-full",handleChange:r=>i("token",r.target.value),disabled:c}),a(b,{className:"mt-2",message:p.token})]})]}),(e==null?void 0:e.data.created_at)&&t(l,{children:[a(d,{children:s("created_at",{context:"male"})}),a("div",{className:"flex-1",children:a(h,{value:F(e.data.created_at).format("DD-MM-YY HH:mm"),readOnly:!0})})]}),(e==null?void 0:e.data.updated_at)&&t(l,{children:[a(d,{children:s("updated_at",{context:"male"})}),a("div",{className:"flex-1",children:a(h,{value:F(e.data.updated_at).format("DD-MM-YY HH:mm"),readOnly:!0})})]})]})}),t(w,{children:[a(P,{children:a(G,{children:s("start_message")})}),t(H,{children:[t(l,{children:[a(d,{htmlFor:"start_message",children:s("message")}),a(I,{children:a($,{id:"start_message",value:((_=n.settings)==null?void 0:_.start_message)||"",className:"w-full",handleChange:r=>i("settings",{...n.settings,start_message:r.target.value}),disabled:c})})]}),t(l,{children:[a(d,{children:s("image")}),a(I,{children:a(z,{file:(x=n.settings)==null?void 0:x.image,onChange:M,imageUrl:((D=e==null?void 0:e.data)==null?void 0:D.image_url)||void 0})})]})]})]}),n.type==="delivery"&&a(U,{value:n.settings,onChange:E})]})})})]})};K.layout=m=>{var s,e,o;return a(B,{children:m,...m.props,header:a(q,{children:(s=m.props.item)!=null&&s.data.id?t(u,{children:[f.t("bot"),": ",(o=(e=m.props.item)==null?void 0:e.data)==null?void 0:o.id]}):t(u,{children:[f.t("bot"),": ",f.t("creation")]})})})};export{K as default};
